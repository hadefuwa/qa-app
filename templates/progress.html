<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Progress - Kids Q&A</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #0f0f23;
            background-image: 
                radial-gradient(at 40% 20%, rgba(120, 119, 198, 0.3) 0px, transparent 50%),
                radial-gradient(at 80% 0%, rgba(120, 119, 198, 0.3) 0px, transparent 50%),
                radial-gradient(at 0% 50%, rgba(120, 119, 198, 0.2) 0px, transparent 50%);
            min-height: 100vh;
            padding: 40px 20px;
            color: #ffffff;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: clamp(2.5rem, 5vw, 4.5rem);
            margin-bottom: 20px;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.02em;
        }
        
        .nav-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        
        .nav-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .progress-table {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .progress-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .progress-table thead {
            background: rgba(102, 126, 234, 0.2);
        }
        
        .progress-table th {
            padding: 20px;
            text-align: left;
            font-weight: 700;
            font-size: 1.1rem;
            color: #ffffff;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .progress-table th:last-child,
        .progress-table td:last-child {
            text-align: right;
        }
        
        .progress-table td {
            padding: 16px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.9);
        }
        
        .progress-table tbody tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .progress-table tbody tr:last-child td {
            border-bottom: none;
        }
        
        .progress-table td:last-child,
        .progress-table td:nth-child(2),
        .progress-table td:nth-child(3) {
            text-align: right;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .quiz-name {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .quiz-emoji {
            font-size: 1.5rem;
        }
        
        @media (max-width: 600px) {
            body {
                padding: 20px 16px;
            }
            
            .progress-table th,
            .progress-table td {
                padding: 12px 16px;
                font-size: 0.9rem;
            }
            
            .quiz-emoji {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä My Progress</h1>
        </div>
        
        <div class="nav-links">
            <a href="/" class="nav-link">üè† Main Menu</a>
            <a href="/progress" class="nav-link">üìä My Progress</a>
        </div>
        
        <div class="progress-table">
            <table>
                <thead>
                    <tr>
                        <th>Quiz Name</th>
                        <th>Completed %</th>
                        <th>Correct %</th>
                    </tr>
                </thead>
                <tbody id="progress-table-body">
                    <!-- Results will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>
    
    <script>
        // Quiz data from server
        const quizzes = {};
        {% for quiz_id, quiz in quizzes.items() %}
        quizzes['{{ quiz_id }}'] = {
            name: {{ quiz.name | tojson }},
            total_questions: {{ quiz.total_questions }},
            emoji: {{ quiz.emoji | tojson }}
        };
        {% endfor %}
        
        // Load progress for all quizzes
        function loadAllProgress() {
            const tableBody = document.getElementById('progress-table-body');
            if (!tableBody) return;
            
            let rowsHTML = '';
            
            // Sort quizzes by name
            const sortedQuizIds = Object.keys(quizzes).sort((a, b) => {
                return quizzes[a].name.localeCompare(quizzes[b].name);
            });
            
            sortedQuizIds.forEach(quizId => {
                const quiz = quizzes[quizId];
                const savedAnswers = localStorage.getItem(quizId + '_answers');
                
                let completionPercent = 0;
                let scorePercent = 0;
                
                if (savedAnswers) {
                    const answers = JSON.parse(savedAnswers);
                    const answered = Object.keys(answers).length;
                    const correct = Object.values(answers).filter(a => a.correct).length;
                    completionPercent = Math.round((answered / quiz.total_questions) * 100);
                    scorePercent = Math.round((correct / quiz.total_questions) * 100);
                }
                
                rowsHTML += `
                    <tr>
                        <td>
                            <div class="quiz-name">
                                <span class="quiz-emoji">${quiz.emoji}</span>
                                <span>${quiz.name}</span>
                            </div>
                        </td>
                        <td>${completionPercent}%</td>
                        <td>${scorePercent}%</td>
                    </tr>
                `;
            });
            
            tableBody.innerHTML = rowsHTML;
        }
        
        // Load all progress when page loads
        loadAllProgress();
        
        // Listen for storage events to update when other tabs update progress
        window.addEventListener('storage', loadAllProgress);
        
        // Also update periodically in case localStorage is updated in the same tab
        setInterval(loadAllProgress, 1000);
    </script>
</body>
</html>
